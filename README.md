# ML : KMeans , Hierarchical ğŸ‘€

## ğŸ“Œ Project Explanation

* pythonì˜ Libraryë“¤ì„ í™œìš©í•˜ì—¬ ìœ ì € ì¸í„°ë™í‹°ë¸Œí•œ ì›¹ ëŒ€ì‹œë³´ë“œ ê°œë°œ
* csv íŒŒì¼ì„ ì—…ë¡œë“œí•  ìˆ˜ ìˆëŠ” ì•±
* ì—…ë¡œë“œí•œ csvíŒŒì¼ì„ dfë¡œ ì½ì„ ìˆ˜ ìˆëŠ” ì•±
* KMeans,Hierarchical í´ëŸ¬ìŠ¤í„°ë§ì„ í•˜ê¸° ìœ„í•´, Xë¡œ ì‚¬ìš©í•  ì»¬ëŸ¼ì„ ì„¤ì •í•  ìˆ˜ ìˆëŠ” ì•±
* ê·¸ë£¹ì˜ ê°¯ìˆ˜ë¥¼ ì •í•  ìˆ˜ ìˆëŠ” ì•±
* ìœ„ì—ì„œ ìœ ì €ë“¤ì´ ì…ë ¥í•œ ë°ì´í„°ë¡œ í´ëŸ¬ìŠ¤í„°ë§í•˜ì—¬ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤.
* AWS EC2ë¥¼ ì´ìš©í•˜ì—¬ ì„œë²„ë¥¼ ê´€ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.
* Github Actionsë¥¼ ì´ìš©í•œ CI/CDë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.
* ìœ ì§€ë³´ìˆ˜ì‘ì—…ì„ ìˆ˜ì›”í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œ ë‹¤ë¥¸ íŒŒì¼ì—ì„œ í•¨ìˆ˜ë¥¼ ë§Œë“¤ê³  ê·¸ í•¨ìˆ˜ë¥¼ importí•´ì„œ ì‘ì—…ì„ í•˜ì˜€ìŠµë‹ˆë‹¤.
* ê° ì»¬ëŸ¼ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ í›„ ë¬¸ìì—´ì¸ì§€ ì•„ë‹Œì§€ ë‚˜ëˆ ì„œ ì²˜ë¦¬ë¥¼ í•˜ë„ë¡ ë°˜ë³µë¬¸ê³¼ ì¡°ê±´ë¬¸ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.
* ë°ì´í„°ì˜ nunique ê°¯ìˆ˜ê°€ 2ê°œ ì´í•˜ì´ë©´ ë ˆì´ë¸”ì¸ì½”ë”©, ê·¸ë ‡ì§€ ì•ˆí¥ë©´ ì›í•«ì¸ì½”ë”© í•˜ë„ë¡  ì½”ë“œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.
* MinMaxScaler í”¼ì³ìŠ¤ì¼€ì¼ë§ì„ ì‚¬ìš©í•˜ì—¬ ì¢€ ë” ì •êµí•œ í´ëŸ¬ìŠ¤í„°ë§ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.



## ğŸ“ŒhyunsungKR
<a href="https://github.com/hyunsungKR/"><img src="https://img.shields.io/badge/GitHub-181717?style=flat-square&logo=GitHub&logoColor=white"/></a> <a href="https://hyunsungstory.tistory.com/"><img src="https://img.shields.io/badge/Tistory-466BB0?style=flat-square&logo=Tistory&logoColor=white"/></a>

## ğŸ“ŒLanguages
<img src="https://img.shields.io/badge/Python-3776AB?style=flat-square&logo=Python&logoColor=white"/>

## ğŸ“Œ Library
<img src="https://img.shields.io/badge/NumPy-013243?style=flat-square&logo=NumPy&logoColor=white"/> <img src="https://img.shields.io/badge/pandas-150458?style=flat-square&logo=pandas&logoColor=white"/> <img src="https://img.shields.io/badge/Streamlit-FF4B4B?style=flat-square&logo=Streamlit&logoColor=white"/> <img src="https://img.shields.io/badge/matplotlib.pyplot-40AEF0?style=flat-square&logo=&logoColor=white"/> 

<img src="https://img.shields.io/badge/Seaborn-006600?style=flat-square&logo=&logoColor=white"/> <img src="https://img.shields.io/badge/scikit-learn-F7931E?style=flat-square&logo=scikit-learn&logoColor=white"/> <img src="https://img.shields.io/badge/SciPy-8CAAE6?style=flat-square&logo=SciPy&logoColor=white"/>   

## ğŸ“ŒTool
<img src="https://img.shields.io/badge/Visual Studio Code-007ACC?style=flat-square&logo=Visual Studio Code&logoColor=white"/> <img src="https://img.shields.io/badge/Anaconda-44A833?style=flat-square&logo=Anaconda&logoColor=white"/> <img src="https://img.shields.io/badge/Amazon AWS-232F3E?style=flat-square&logo=Amazon AWS&logoColor=white"/> 

## ğŸ“ŒCode block
```python
 # csvíŒŒì¼ì„ ì—…ë¡œë“œ ë°›ê³  NaN ì‚­ì œ ì½”ë“œ 
    file = st.file_uploader('CSVíŒŒì¼ ì—…ë¡œë“œ', type=['csv'])
    st.warning('ê²°ì¸¡ì¹˜ëŠ” ìë™ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤.')
    df = pd.read_csv(file)
    df = df.dropna()
```
```python
# ì¸ì½”ë”© ì‘ì—… forë¬¸ê³¼ ifë¬¸

            X_new = pd.DataFrame()

            for name in X.columns :

                # ê° ì»¬ëŸ¼ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
                data=X[name]
                data.reset_index(inplace=True,drop=True)
                # ë¬¸ìì—´ì¸ì§€ ì•„ë‹Œì§€ ë‚˜ëˆ ì„œ ì²˜ë¦¬í•˜ë©´ ëœë‹¤.
                if data.dtype == object :
                    
                    # ë¬¸ìì—´ì´ë‹ˆ, ê°¯ìˆ˜ê°€ 2ê°œì¸ì§€ ì•„ë‹Œì§€ íŒŒì•…í•´ì„œ
                    # 2ê°œì´ë©´ ë ˆì´ë¸” ì¸ì½”ë”©, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´
                    # ì›í•« ì¸ì½”ë”© í•˜ë„ë¡ ì½”ë“œ ì‘ì„±
                    if data.nunique() <= 2 :
                        #ë ˆì´ë¸” ì¸ì½”ë”©
                        label_encoder = LabelEncoder()
                        X_new[name]=label_encoder.fit_transform(data)
                    else :
                        # ì›í•« ì¸ì½”ë”©
                        ct = ColumnTransformer ( [('encoder',OneHotEncoder(),[0])],
                                remainder='passthrough')
                        col_names=sorted(data.unique())
                        X_new[col_names]=ct.fit_transform(data.to_frame())
                else :
                    # ìˆ«ì ë°ì´í„° ì²˜ë¦¬
                    
                    X_new[name] = data
```
```python
# MinMaxScalerë¥¼ ì´ìš©í•œ í”¼ì³ìŠ¤ì¼€ì¼ë§ê³¼ì •
            scaler = MinMaxScaler()
            X_new = scaler.fit_transform(X_new)
```
## ğŸ“Œ ML : KMeans
* Using Model : from sklearn.cluster import KMeans
```python
# wcss (Within Clusters Sum of Squares)
            wcss = []
            for k in np.arange(1,max_number+1):
                kmeans=KMeans(n_clusters=k,random_state=5)
                kmeans.fit(X_new)
                wcss.append(kmeans.inertia_)
```
```python
# WCSSê°’ì„, ì°¨íŠ¸ë¡œ ë‚˜íƒ€ë‚´ë¼. => ì—˜ë³´ìš° ë©”ì†Œë“œ(Elbow Method)
            max_number=st.number_input('ìµœëŒ€ ê·¸ë£¹ ì„ íƒ',2,20,value=10)
            x = np.arange(1,max_number+1)
            fig1 = plt.figure()
            plt.plot(x,wcss)
            plt.title('The Elbow Method')
            plt.xlabel('Number of Clusters')
            plt.ylabel('WCSS')
            st.pyplot(fig1)
```
```python
# KMeans í•™ìŠµ ê³¼ì •
            k=st.number_input('ê·¸ë£¹ ê°¯ìˆ˜ ê²°ì •',1,max_number)

            kmeans = KMeans(n_clusters=k,random_state=5)
            y_pred = kmeans.fit_predict(X_new)
```
## ğŸ“Œ ML : Hierarchical
* Using Model : import scipy.cluster.hierarchy as sch / from sklearn.cluster import AgglomerativeClustering
```python
# Dendrogramì„ ê·¸ë ¤ ìµœì ì˜ í´ëŸ¬ìŠ¤í„° ê°¯ìˆ˜ë¥¼ ì°¾ì•„ë³´ê¸°
            fig2=plt.figure()
            sch.dendrogram(sch.linkage(X_new,method='ward'))
            plt.title('Dendrogram')
            plt.xlabel('Custromers')
            plt.ylabel('Euclidean Distances')
            st.pyplot(fig2)
```
```python
# Hierarchical í•™ìŠµ ê³¼ì •
            k=st.number_input('ê·¸ë£¹ ê°¯ìˆ˜ ê²°ì •',1,20)

            hc = AgglomerativeClustering(n_clusters= k)
            y_pred = hc.fit_predict(X_new)
            df['Group']=y_pred
```



## ğŸ“Œ URL
  - http://ec2-3-36-77-30.ap-northeast-2.compute.amazonaws.com:8503/

## ğŸ“Œ Screen Shot
![image](https://user-images.githubusercontent.com/120348500/208033210-03930c10-2009-4498-8750-8a5cde771de3.png)
![image](https://user-images.githubusercontent.com/120348500/208033299-bfa6ce0a-fd6f-4fad-81a6-cec24ae5e96c.png)
![image](https://user-images.githubusercontent.com/120348500/208033408-f3f6f4ed-362a-4a8c-97ec-c2ec04129a0f.png)
![image](https://user-images.githubusercontent.com/120348500/208033502-543c2e74-344d-46cb-b919-e953f8d923c7.png)
![image](https://user-images.githubusercontent.com/120348500/208033576-ea73a230-400e-4694-b152-696bd883f174.png)

## ğŸ“Œ Reference

ë©”ì¸í™”ë©´ ë™ì˜ìƒ : https://youtu.be/PeMlggyqz0Y
